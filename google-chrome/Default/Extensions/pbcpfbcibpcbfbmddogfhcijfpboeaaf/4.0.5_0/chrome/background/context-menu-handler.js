import{getOptions}from"./options-messenger.js";import{popout}from"./command-handler.js";import{logger}from"../helpers.js";let inspectMode=!1;const context={all:["page","selection","editable","link","frame","image","video"]};function changeInspectMode(e){logger.log("debug","changeInspectMode",e.url),chrome.tabs.sendMessage(e.id,{type:"inspect"}).catch(e=>logger.log("warn","sendMessage",e.message))}const contextMenuMessageHandler=async(e,t,n)=>"drops"==e.type&&(chrome.tabs.captureVisibleTab(null,{format:"png"},function(e){n(e)}),!0),contextMenuTabsOnActivatedHandler=({tabId:e})=>{chrome.tabs.sendMessage(e,{type:"inspect",query:"state"}).catch(e=>logger.log("warn","sendMessage",e.message))};function addContextMenu(){removeContextMenu();var e="mainContextMenu";chrome.contextMenus.create({id:e,title:"Amino",contexts:context.all}),chrome.contextMenus.create({id:"inspectItem",parentId:e,title:"Inspect Elements",contexts:context.all}),chrome.contextMenus.create({id:"separatorOne",parentId:e,type:"separator",contexts:context.all}),chrome.contextMenus.create({id:"openEditorItem",parentId:e,title:"Open Editor",contexts:context.all}),chrome.contextMenus.create({id:"separatorTwo",parentId:e,type:"separator",contexts:context.all})}function removeContextMenu(){chrome.contextMenus.removeAll()}const setContextMenu=async()=>{var e=await getOptions();(void 0===e.context||!0===e.context?addContextMenu:removeContextMenu)()};chrome.contextMenus.onClicked.addListener(({menuItemId:e},t)=>{switch(e){case"inspectItem":changeInspectMode(t);break;case"openEditorItem":popout()}});export{contextMenuMessageHandler,contextMenuTabsOnActivatedHandler,setContextMenu};